webpackJsonp([0],{1186:function(e,t,n){"use strict";function a(e){return console.log(e),{type:p,payload:e}}function r(e){return{type:m,payload:e}}function o(e){return{type:f,payload:e}}function l(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:y,t=arguments[1],n=b[t.type];return n?n(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"COUPON_ADD",function(){return p}),n.d(t,"COUPON_SELECTED",function(){return m}),n.d(t,"COUPON_STARTED_CHANGE",function(){return f}),n.d(t,"COUNTER_INCREMENT",function(){return C}),n.d(t,"COUNTER_DOUBLE_ASYNC",function(){return h}),t.couponAdd=a,t.couponSelected=r,t.couponStartedChange=o,n.d(t,"actions",function(){return E}),t.default=l;var c,i=n(9),u=n.n(i),s=n(65),d=n.n(s),p="COUPON_ADD",m="COUPON_SELECTED",f="COUPON_STARTED_CHANGE",C="COUNTER_INCREMENT",h="COUNTER_DOUBLE_ASYNC",v=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Number(Math.random().toString().substr(3,e)+Date.now()).toString(36)},E={couponSelected:r,couponStartedChange:o,couponAdd:a},b=(c={},u()(c,p,function(e,t){var n=t.payload;return console.log(n),n.length?(n.map(function(e){if(!e.id)return e.id="JD_"+v()}),n=n.filter(function(e){return e.url&&e.title&&e.priceLess})):n.url&&!n.id&&(n.id="JD_"+v(),n=[n]),Object.assign({},e,{list:[].concat(d()(e.list),d()(n))})}),u()(c,m,function(e,t){var n=t.payload;return Object.assign({},e,{list:e.list.map(function(e){return e.id===n.id&&(e.isSelected=!e.isSelected),e})})}),u()(c,f,function(e,t){var n=t.payload;return Object.assign({},e,{list:e.list.map(function(e){return e.isSelected&&(e.started=n),e})})}),u()(c,h,function(e,t){return 2*e}),c),y={list:[{id:"JD_1",title:"话费券",priceLess:"50",condition:"满50可用",url:"http://coupon.m.jd.com/center/receiveCoupon.json?couponId=FP_rzw62e&roleId=9522110&actId=5550d895d0e8447a82366b4667a5a079",note:"10点开抢"},{id:"JD_2",title:"仅可购买母婴玩具自营（除童装童鞋）部分商品",priceLess:"100",condition:"满399可用",url:"http://coupon.m.jd.com/center/receiveCoupon.json?couponId=FP_r6zwli&roleId=9563848&actId=f62f9b45d4f94870b0c99ecaba36ceb7",note:"16点开抢"},{id:"JD_3",title:"全品类",priceLess:"10",condition:"满200可用",url:"http://api.m.jd.com/client.action?functionId=newBabelAwardCollection&body=%7B%22activityId%22%3A%22JnBNfziTrMkqi6mBCaegM3SdVTL%22%2C%22from%22%3A%22H5node%22%2C%22scene%22%3A%221%22%2C%22args%22%3A%22key%3Da327e6761c5a475db749ac9c0d09000e%2CroleId%3D9491958%22%2C%22mitemAddrId%22%3A%22%22%2C%22geo%22%3A%7B%22lng%22%3A%22%22%2C%22lat%22%3A%22%22%7D%7D&client=wh5&clientVersion=1.0.0&sid=2ef0a060f4976cf16ce8dacbbb4acdaa&uuid=1486988610523463373612&area=&_=1512870608248&callback=jsonp5",note:"10点开抢"},{id:"JD_4",title:"全品类",priceLess:"20",condition:"满400可用",url:"https://api.m.jd.com/client.action?functionId=newBabelAwardCollection&body=%7B%22activityId%22%3A%22JnBNfziTrMkqi6mBCaegM3SdVTL%22%2C%22from%22%3A%22H5node%22%2C%22scene%22%3A%221%22%2C%22args%22%3A%22key%3Dbeb14768b14c4a5eb56af44d286ca58a%2CroleId%3D9490476%22%2C%22mitemAddrId%22%3A%22%22%2C%22geo%22%3A%7B%22lng%22%3A%22%22%2C%22lat%22%3A%22%22%7D%7D&client=wh5&clientVersion=1.0.0&sid=2ef0a060f4976cf16ce8dacbbb4acdaa&uuid=1486988610523463373612&area=&_=1512870737852&callback=jsonp6",note:"10点开抢"},{id:"JD_5",title:"仅可购买自营尿裤部分商品",priceLess:"100",condition:"满399可用",url:"http://coupon.m.jd.com/center/receiveCoupon.json?couponId=FP_rxzlqk&roleId=9487347&actId=6bd6339fd57d45a4a91f34e0d3783e5a",note:"16点开抢"}]}},1187:function(e,t,n){"use strict";function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return{type:i,payload:e}}function r(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:m,t=arguments[1],n=p[t.type];return n?n(e,t):e}Object.defineProperty(t,"__esModule",{value:!0}),n.d(t,"COUNTER_INCREMENT",function(){return i}),n.d(t,"COUNTER_DOUBLE_ASYNC",function(){return u}),t.increment=a,n.d(t,"doubleAsync",function(){return s}),n.d(t,"actions",function(){return d}),t.default=r;var o,l=n(9),c=n.n(l),i="COUNTER_INCREMENT",u="COUNTER_DOUBLE_ASYNC",s=function(){return function(e,t){return new Promise(function(n){setTimeout(function(){e({type:u,payload:t().counter}),n()},200)})}},d={increment:a,doubleAsync:s},p=(o={},c()(o,i,function(e,t){return e+t.payload}),c()(o,u,function(e,t){return 2*e}),o),m=0},1189:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(138),r=n(1187),o=n(1198),l={increment:function(){return n.i(r.increment)(1)},doubleAsync:r.doubleAsync},c=function(e){return{counter:e.counter}};t.default=n.i(a.connect)(c,l)(o.a)},1190:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(138),r=n(1186),o=n(1199),l={couponSelected:function(e){return n.i(r.couponSelected)(e)},couponAdd:function(e){return n.i(r.couponAdd)(e)},couponStartedChange:function(e){return n.i(r.couponStartedChange)(e)}},c=function(e){return Object.assign({selectedCoupons:e.coupons.list.filter(function(e){return e.isSelected})},e)};t.default=n.i(a.connect)(c,l)(o.a)},1194:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(5),l=(n.n(o),n(524)),c=function(e){return r.a.createElement(l.g,{message:"提示",description:r.a.createElement("div",null,"抢券前请确保已登陆京东 ",r.a.createElement("a",{target:"_blank",href:"http://home.jd.com/"},"登录电脑版")," ",r.a.createElement("a",{target:"_blank",href:"https://home.m.jd.com/myJd/newhome.action"},"登录手机版")),type:"warning",showIcon:!0})};c.propTypes={},t.a=c},1195:function(e,t,n){"use strict";var a=n(1),r=n.n(a),o=n(8),l=n.n(o),c=n(3),i=n.n(c),u=n(2),s=n.n(u),d=n(0),p=n.n(d),m=n(524),f=function(e){function t(){var e,n,a,o;r()(this,t);for(var l=arguments.length,c=Array(l),u=0;u<l;u++)c[u]=arguments[u];return n=a=i()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(c))),a.state={started:!1,result:!1},a.componentWillReceiveProps=function(e){var t=e.item,n=e.show;t.started&&"selected"===n?a.startCoupon(t):a.endCoupon(t)},a.timer=[],a.next=0,a.startCoupon=function(e){var t=e.id,n=e.url;a.setState({started:!0,result:!0}),a.timer[t]=setInterval(function(){console.log({id:t,url:n}),this.next,$("#iframe"+t).attr("src",n),this.next=this.next+1},320)},a.endCoupon=function(e){var t=e.id;a.timer[t]&&(a.setState({result:!1}),clearInterval(a.timer[t]))},a.onCouponSelected=function(e){var t=a.props.couponSelected;a.setState({started:!1}),a.timer[e.id]&&a.endCoupon(e),t(e)},o=n,i()(a,o)}return s()(t,e),l()(t,[{key:"render",value:function(){var e=this,t=this.props,n=t.item,a=t.show;return p.a.createElement(m.f,{span:6,"data-url":n.url,className:"gutter-row coupon-item"},p.a.createElement("div",null,p.a.createElement("div",{className:"price"},p.a.createElement("em",null,"¥"),p.a.createElement("strong",null,n.priceLess)),p.a.createElement("div",null,p.a.createElement("span",{className:"limit"},n.condition),/m.jd/.test(n.url)?p.a.createElement("span",{className:"device"},"手机端"):p.a.createElement("span",{className:"device"},"PC端")),p.a.createElement("h3",{dangerouslySetInnerHTML:{__html:n.title}}),p.a.createElement("p",{dangerouslySetInnerHTML:{__html:n.note?n.note:"请确保已登陆京东"}}),p.a.createElement("p",null,n.baseUrl?p.a.createElement("a",{href:n.baseUrl,target:"_blank"},"直达优惠券页面"):"")),this.state.started?p.a.createElement("div",null,p.a.createElement("iframe",{id:"iframe"+n.id,src:""})):"",function(t){switch(a){case"all":return p.a.createElement("div",{className:"control"},p.a.createElement(m.b,{type:"primary",onClick:e.onCouponSelected.bind(e,t),disabled:t.isSelected},"选择"));case"selected":return p.a.createElement("div",{className:"control justify"},e.state.result?p.a.createElement(m.b,{type:"primary",onClick:e.endCoupon.bind(e,t)},"结束抢券"):p.a.createElement(m.b,{type:"primary",onClick:e.startCoupon.bind(e,t)},"开始抢券"),p.a.createElement(m.b,{type:"danger",onClick:e.onCouponSelected.bind(e,t)},"删除"))}}(n))}}]),t}(d.Component);t.a=f},1197:function(e,t,n){"use strict";var a=n(4),r=n.n(a),o=n(1),l=n.n(o),c=n(8),i=n.n(c),u=n(3),s=n.n(u),d=n(2),p=n.n(d),m=n(0),f=n.n(m),C=n(102),h=n(524),v=h.a.Item,E=h.c.TextArea,b=function(e){function t(){l()(this,t);var e=s()(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return e.handleFormDataChange=function(t){e.setState({byData:!e.state.byData})},e.state={byData:!0},e}return p()(t,e),i()(t,[{key:"render",value:function(){var e=this.props,t=e.visible,n=e.onCancel,a=e.onCreate,o=e.form,l=o.getFieldDecorator,c={labelCol:{xs:{span:24},sm:{span:5}},wrapperCol:{xs:{span:24},sm:{span:18}}};return f.a.createElement(h.j,{visible:t,title:"添加优惠券",okText:"添加",cancelText:"取消",onCancel:n,onOk:a},f.a.createElement(h.a,{layout:"horizontal"},f.a.createElement(v,r()({},c,{label:"数据格式"}),l("dataType",{valuePropName:"checked"})(f.a.createElement(h.l,{checkedChildren:"字段",unCheckedChildren:"JSON",onChange:this.handleFormDataChange}))),this.state.byData?f.a.createElement(v,r()({},c,{label:f.a.createElement("span",null,"数据 ",f.a.createElement(h.i,{title:"请使用优惠券数据提取工具"},f.a.createElement(C.Link,{to:"/tool"},f.a.createElement(h.m,{type:"question-circle-o"})))),help:"支持数组或者对象数据提交"}),l("data",{rules:[{required:!0,message:"请填写数据"}]})(f.a.createElement(E,{rows:4,placeholder:"请填写数据"}))):f.a.createElement("div",null,f.a.createElement(v,r()({},c,{label:"标题"}),l("title",{rules:[{required:!0,message:"请填写标题"}]})(f.a.createElement(h.c,{placeholder:"请填写标题"}))),f.a.createElement(v,r()({},c,{label:f.a.createElement("span",null,"接口地址 ",f.a.createElement(h.i,{title:"请使用优惠券接口地址提取工具"},f.a.createElement(C.Link,{to:"/tool"},f.a.createElement(h.m,{type:"question-circle-o"}))))}),l("url",{rules:[{required:!0,message:"请输入接口地址"},{pattern:/^((https:|http:)?\/\/).*jd.com+.*/,message:"请输入正确的京东接口地址）"}]})(f.a.createElement(h.c,{placeholder:"请输入京东接口地址"}))),f.a.createElement(v,r()({},c,{label:"备注信息"}),l("note")(f.a.createElement(h.c,{placeholder:"备注信息"}))),f.a.createElement(v,r()({},c,{label:"折扣力度"}),l("priceLess",{rules:[{required:!0,message:"请填写折扣力度"}]})(f.a.createElement(h.c,{placeholder:"折扣力度"}))),f.a.createElement(v,r()({},c,{label:"条件"}),l("condition")(f.a.createElement(h.c,{placeholder:"满多少可用"}))))))}}]),t}(f.a.Component),y=h.a.create()(b);t.a=y},1198:function(e,t,n){"use strict";var a=n(0),r=n.n(a),o=n(5),l=n.n(o),c=function(e){var t=e.counter,n=e.increment,a=e.doubleAsync;return r.a.createElement("div",{style:{margin:"0 auto"}},r.a.createElement("a",{href:"javascript:(function(){var key=$('#key').val(),roleId=$('#roleId').val(),couponKey=$('#couponKey').val(),title=$('.coupon-info .use-rule').html()||'',priceLess=$('.value-content .money strong').text()||'',condition=$('.value-content .rule').text()||'',note=$('.coupon-info .use-time').text()||'',url='http://coupon.m.jd.com/center/receiveCoupon.json?couponId='+couponKey+'&roleId='+roleId+'&actId='+key,str = '{title:\\''+title.trim().replace(/\\s/g,'')+'\\',priceLess:\\''+priceLess.trim()+'\\',condition:\\''+condition.trim()+'\\',note:\\''+note.trim()+'\\',url:\\''+url+'\\'}';prompt('couponData',str)}())"},"优惠券页面数据提取"),r.a.createElement("h2",null,"Counter: ",t),r.a.createElement("button",{className:"btn btn-primary",onClick:n},"Increment")," ",r.a.createElement("button",{className:"btn btn-secondary",onClick:a},"Double (Async)"))};c.propTypes={counter:l.a.number.isRequired,increment:l.a.func.isRequired,doubleAsync:l.a.func.isRequired},t.a=c},1199:function(e,t,n){"use strict";var a=n(25),r=n.n(a),o=n(1),l=n.n(o),c=n(8),i=n.n(c),u=n(3),s=n.n(u),d=n(2),p=n.n(d),m=n(0),f=n.n(m),C=n(1195),h=n(524),v=n(6),E=n.n(v),b=n(1197),y=n(1194),g=function(e){function t(){var e,n,a,o;l()(this,t);for(var c=arguments.length,i=Array(c),u=0;u<c;u++)i[u]=arguments[u];return n=a=s()(this,(e=t.__proto__||Object.getPrototypeOf(t)).call.apply(e,[this].concat(i))),a.state={mode:"time",visible:!1,visibleAddCoupon:!1,date:""},a.handleOk=function(e){console.log(a.state.date),a.setState({visible:!1}),a.setTimer()},a.handleCancel=function(e){a.setState({visible:!1,visibleAddCoupon:!1})},a.handleOnChange=function(e,t){console.log(t),a.setState({date:t})},a.setCouponTime=function(){a.setState({visible:!0,date:E()(E()().valueOf()+5e3).format("YYYY-MM-DD HH:mm:ss")})},a.setTimer=function(){function e(){var a=(new Date).getTime();i++,console.log(a%1e3);var l=E()().valueOf()-(o+i*n),s=n-l;s<0&&(s=0),console.log(s),c<0||c<n?(clearTimeout(u),t.startCouponAll(),console.log((r-E()().valueOf())/1e3),console.log("时间到"),setTimeout(function(){t.endCouponAll()},3e3)):(h.h.info("距离开抢还有："+c/1e3+"s"),u=setTimeout(e,n)),c-=n}if(!a.props.selectedCoupons.length)return h.h.error("当前还没有选择任何优惠券");var t=a,n=1e3,r=E()(a.state.date).valueOf(),o=E()().valueOf(),l=o%1e3,c=r-o,i=0;console.log(c,l);var u=void 0;c>=0&&(u=setTimeout(e,1e3-l))},a.startCouponAll=function(){var e=a.props,t=e.couponStartedChange;if(!e.selectedCoupons.length)return h.h.error("当前还没有选择任何优惠券");t(!0)},a.endCouponAll=function(){var e=a.props,t=e.couponStartedChange,n=e.selectedCoupons;n.filter(function(e){return!0===e.started});if(!n.length)return h.h.error("当前还没有选择任何优惠券");t(!1)},a.addCoupon=function(){a.setState({visibleAddCoupon:!0})},a.handleCreate=function(){var e=a.props.couponAdd,t=a.form;t.validateFields(function(n,o){if(!n){if(o.data){try{o=JSON.parse(o.data)}catch(e){return h.h.error("数据格式错误")}if("object"!==(void 0===o?"undefined":r()(o)))return h.h.error("数据格式错误")}else delete o.dataType;console.log("Received values of form: ",o),e(o),t.resetFields(),a.setState({visibleAddCoupon:!1})}})},a.saveFormRef=function(e){a.form=e},o=n,s()(a,o)}return p()(t,e),i()(t,[{key:"render",value:function(){var e=this.props,t=e.selectedCoupons,n=e.coupons,a=e.couponSelected,r=n.list;h.a.Item;return f.a.createElement("div",null,f.a.createElement(y.a,null),f.a.createElement(h.d,{style:{marginTop:24},type:"inner",title:"抢券列表",extra:f.a.createElement("span",null,f.a.createElement(h.b,{type:"primary",onClick:this.startCouponAll},"一键抢券")," ",f.a.createElement(h.b,{type:"primary",onClick:this.endCouponAll},"一键结束")," ",f.a.createElement(h.b,{type:"primary",onClick:this.setCouponTime},"定时抢券"))},f.a.createElement(h.e,{gutter:50},t.map(function(e,t){return f.a.createElement(C.a,{item:e,key:e.id,couponSelected:a,show:"selected"})}))),f.a.createElement(h.d,{style:{marginTop:24},type:"inner",title:"优惠券列表",extra:f.a.createElement("span",null,f.a.createElement(h.b,{type:"primary",onClick:this.addCoupon},"添加优惠券"))},f.a.createElement(h.e,{gutter:50},r.map(function(e,t){return f.a.createElement(C.a,{item:e,key:e.id,couponSelected:a,show:"all"})}))),f.a.createElement(h.j,{visible:this.state.visible,okText:"确定",cancelText:"取消",onOk:this.handleOk,onCancel:this.handleCancel},f.a.createElement("div",null,f.a.createElement(h.k,{mode:this.state.mode,format:"YYYY-MM-DD HH:mm:ss",showTime:!0,value:E()(this.state.date,"YYYY-MM-DD HH:mm:ss"),onChange:this.handleOnChange,onPanelChange:this.handlePanelChange}),f.a.createElement("p",null,"准确的时间格式：2017-12-03 10:00:00，3秒后自动结束"))),f.a.createElement(b.a,{ref:this.saveFormRef,visible:this.state.visibleAddCoupon,onCancel:this.handleCancel,onCreate:this.handleCreate}))}}]),t}(m.Component);t.a=g}});