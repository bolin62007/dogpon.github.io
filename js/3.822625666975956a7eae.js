webpackJsonp([3],{1191:function(e,n,t){"use strict";function r(e){return console.log(JSON.stringify(e)),{type:u,payload:e}}function o(e){return{type:m,payload:e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:v,n=arguments[1],t=h[n.type];return t?t(e,n):e}Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"COUPON_GRAB_ADD",function(){return u}),t.d(n,"COUPON_SELECTED",function(){return m}),n.couponAdd=r,n.couponSelected=o,t.d(n,"actions",function(){return f}),n.default=a;var i,c=t(9),l=t.n(c),s=t(65),d=t.n(s),u="COUPON_GRAB_ADD",m="COUPON_SELECTED",p=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Number(Math.random().toString().substr(3,e)+Date.now()).toString(36)},f={couponSelected:o,couponAdd:r},h=(i={},l()(i,u,function(e,n){var t=n.payload;return t.length?(t.map(function(e){if(!e.id)return e.id="JD_"+p()}),t=t.filter(function(e){return e.url&&e.title&&e.priceLess})):t.url&&!t.id&&(t.id="JD_"+p(),t=[t]),[].concat(d()(e),d()(t))}),l()(i,m,function(e,n){var t=n.payload;return[].concat(d()(e.map(function(e){return e.id===t.id&&(e.isSelected=!e.isSelected),e})))}),i),v=[]},1195:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var r=t(138),o=t(1191),a=t(1240),i={couponSelected:o.couponSelected,couponAdd:o.couponAdd},c=function(e){return e};n.default=t.i(r.connect)(c,i)(a.a)},1201:function(e,n,t){"use strict";var r=t(0),o=t.n(r),a=t(5),i=(t.n(a),t(525)),c=function(e){var n=e.description;return o.a.createElement(i.i,{message:"提示",description:n||o.a.createElement("div",null,"抢券前请确保已登陆京东 ",o.a.createElement("a",{target:"_blank",href:"http://home.jd.com/"},"登录电脑版")," ",o.a.createElement("a",{target:"_blank",href:"https://home.m.jd.com/myJd/newhome.action"},"登录手机版")),type:"warning",showIcon:!0})};c.propTypes={},n.a=c},1204:function(e,n,t){"use strict";var r=t(1),o=t.n(r),a=t(8),i=t.n(a),c=t(3),l=t.n(c),s=t(2),d=t.n(s),u=t(0),m=t.n(u),p=t(525),f=function(e){function n(){var e,t,r,a;o()(this,n);for(var i=arguments.length,c=Array(i),s=0;s<i;s++)c[s]=arguments[s];return t=r=l()(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(c))),r.state={started:!1,result:!1},r.componentWillReceiveProps=function(e){var n=e.item,t=e.show;n.started&&"selected"===t?r.startCoupon(n):r.endCoupon(n)},r.timer=[],r.next=0,r.startCoupon=function(e){var n=e.id,t=e.url;r.setState({started:!0,result:!0}),r.timer[n]=setInterval(function(){console.log({id:n,url:t}),this.next,$("#iframe"+n).attr("src",t),this.next=this.next+1},320)},r.endCoupon=function(e){var n=e.id;r.timer[n]&&(r.setState({result:!1}),clearInterval(r.timer[n]))},r.onCouponSelected=function(e){var n=r.props.couponSelected;r.setState({started:!1}),r.timer[e.id]&&r.endCoupon(e),n(e)},r.onCouponDel=function(e){(0,r.props.couponDel)(e)},r.onCouponLocal=function(e){(0,r.props.couponLocal)(e)},a=t,l()(r,a)}return d()(n,e),i()(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.item,r=n.show;return m.a.createElement(p.g,{span:6,"data-url":t.url,className:"gutter-row coupon-item"},m.a.createElement("div",null,m.a.createElement("div",{className:"price"},m.a.createElement("em",null,"¥"),m.a.createElement("strong",null,t.priceLess)),m.a.createElement("div",null,m.a.createElement("span",{className:"limit"},t.condition),/m.jd/.test(t.url)?m.a.createElement("span",{className:"device"},"手机端"):m.a.createElement("span",{className:"device"},"PC端")),m.a.createElement("h3",{dangerouslySetInnerHTML:{__html:t.title}}),m.a.createElement("p",{dangerouslySetInnerHTML:{__html:t.note?t.note:"请确保已登陆京东"}}),m.a.createElement("p",null,t.baseUrl?m.a.createElement("a",{href:t.baseUrl,target:"_blank"},"直达优惠券页面"):"")),this.state.started?m.a.createElement("div",null,m.a.createElement("iframe",{id:"iframe"+t.id,src:""})):"",function(n){switch(r){case"all":return m.a.createElement("div",{className:"control justify"},m.a.createElement(p.b,{type:"primary",onClick:e.onCouponSelected.bind(e,n),disabled:n.isSelected},m.a.createElement(p.h,{type:"heart"})," 选择")," ",m.a.createElement(p.b,{type:"danger",onClick:e.onCouponDel.bind(e,n),disabled:n.isSelected},m.a.createElement(p.h,{type:"delete"})," 删除"));case"selected":return m.a.createElement("div",{className:"control justify"},e.state.result?m.a.createElement(p.b,{type:"danger",onClick:e.endCoupon.bind(e,n)},m.a.createElement(p.h,{type:"rocket"})," 结束抢券"):m.a.createElement(p.b,{type:"primary",onClick:e.startCoupon.bind(e,n)},m.a.createElement(p.h,{type:"rocket"})," 开始抢券"),m.a.createElement(p.b,{type:"danger",onClick:e.onCouponSelected.bind(e,n)},m.a.createElement(p.h,{type:"heart-o"})," 删除"));case"serve":return m.a.createElement("div",{className:"control"},m.a.createElement(p.b,{type:"primary",onClick:e.onCouponLocal.bind(e,n),disabled:n.isInLocal},m.a.createElement(p.h,{type:"cloud-download"})," ",n.isInLocal?"本地已保存":"选择到本地"))}}(t))}}]),n}(u.Component);n.a=f},1205:function(e,n,t){"use strict";var r=t(1),o=t.n(r),a=t(8),i=t.n(a),c=t(3),l=t.n(c),s=t(2),d=t.n(s),u=t(0),m=t.n(u),p=t(525),f=t(1206),h=t.n(f),v=t(1207),w=t.n(v),b=function(e){function n(){o()(this,n);var e=l()(this,(n.__proto__||Object.getPrototypeOf(n)).call(this));return e.state={byData:!0},e}return d()(n,e),i()(n,[{key:"render",value:function(){var e=this.props,n=e.visible,t=e.onCancel;e.onCreate;return m.a.createElement(p.f,{visible:n,title:"给我来瓶红牛，回点能量！",footer:[m.a.createElement(p.b,{key:"back",onClick:t,type:"primary"},"关闭")],onCancel:t},m.a.createElement(p.e,null,m.a.createElement(p.g,{span:12},m.a.createElement("img",{src:h.a})),m.a.createElement(p.g,{span:12},m.a.createElement("img",{src:w.a}))))}}]),n}(u.Component);n.a=b},1206:function(e,n,t){e.exports=t.p+"images/wx.png"},1207:function(e,n,t){e.exports=t.p+"images/zfb.png"},1237:function(e,n,t){"use strict";var r=t(525),o=function(e,n){try{var t=window.require("electron").remote.BrowserWindow;window.require("electron").ipcRenderer,t.getFocusedWindow().id;console.log(window.require("electron"));var o="https://wqs.jd.com/order/s_confirm_miao.shtml?scene=jd&isCanEdit=1&src=&commlist=,,1,"+e+"&urlType=login#wechat_redirect",a=new t({width:400,height:550,show:!0});a.loadURL(o),a.webContents.on("did-finish-load",function(){a.webContents.executeJavaScript("\n        var tcUrl = `https://wqs.jd.com/order/s_confirm_miao.shtml?scene=jd&isCanEdit=1&src=&commlist=,,1,"+e+"&urlType=login#wechat_redirect`\n        // 订单提交速度，测试在4750ms提交一次才行\n        var tcDelay = 4750;\n        // 如果抢购失败则关闭弹窗 继续抢购\n        function tc ($el,$btn){\n          if($btn){$btn.trigger('click')}\n            $el.trigger('click')\n        }\n        // 监听弹出窗口并继续抢购\n        $('body').bind('DOMNodeInserted', function(e) {\n          var $btn = $(e.target).find('.btn')\n          if($btn.length){\n            setTimeout(function(){\n            tc($(\"#btnWxH5Pay\"),$btn)\n          },tcDelay)\n          }\n        });\n        // 防止多次提交后不会弹窗，只是一串提示信息\n        $('#wrapBody').bind('DOMNodeInserted', function(e) {\n          var $info = $(e.target).hasClass('show')\n          if($info){\n            setTimeout(function(){\n              tc($(\"#btnWxH5Pay\"))\n            },tcDelay)\n          }\n        });\n\n        // 判断是否为抢购页面\n        if(/s_confirm_miao.shtml/.test(location.href)){\n          // 点击微信支付\n          tc($(\"#btnWxH5Pay\"))\n        }else if(/plogin.m.jd.com/.test(location.href)){\n          // 如果为登录页面 则等待登录\n          // message.info(等待登录)\n        }else{\n          location.href = tcUrl\n          // console.log(tcUrl)\n          // tc($(\"#btnWxH5Pay\"))\n        }\n        // var tc_result ='hi'\n        // const ipc = window.require('electron').ipcRenderer\n        // // var BrowserWindow = BrowserWindow\n        // // var ipc = ipcRenderer\n        // const BrowserWindow = window.require('electron').remote.BrowserWindow\n        // ipc.on('compute-factorial', function (event, fromWindowId) {\n        //   const fromWindow = BrowserWindow.fromId(fromWindowId)\n        //   fromWindow.webContents.send('grab-finished', tc_result)\n        //   window.close()\n        // })\n      ")})}catch(e){r.j.error("不支持网页访问")}};n.a=o},1240:function(e,n,t){"use strict";var r=t(1),o=t.n(r),a=t(8),i=t.n(a),c=t(3),l=t.n(c),s=t(2),d=t.n(s),u=t(0),m=t.n(u),p=t(5),f=(t.n(p),t(525)),h=t(1201),v=t(1204),w=t(1205),b=t(1241),y=t(1237),g=f.a.Item,E=function(e){function n(){var e,r,a,i;o()(this,n);for(var c=arguments.length,s=Array(c),d=0;d<c;d++)s[d]=arguments[d];return r=a=l()(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(s))),a.state={visible:!1},a.handleSubmit=function(e){e.preventDefault(),a.props.form.validateFields(function(e,n){var r=n.url;e||(console.log("Received values of form: ",r),t.i(b.a)(r,a))})},a.resultSet=function(e){(0,a.props.couponAdd)(e)},a.selectCoupon=function(e){var n=a.props,t=n.couponSelected;(0,n.couponPost)(e),t(e)},a.qg=function(e){var n=e.proId,r=void 0===n?1135611:n;t.i(y.a)(r)},a.donation=function(){a.setState({visible:!0})},a.handleCancel=function(e){a.setState({visible:!1})},i=r,l()(a,i)}return d()(n,e),i()(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.grab,r=n.form,o=r.getFieldDecorator;return m.a.createElement("div",{ref:"grab"},m.a.createElement(h.a,{description:m.a.createElement("div",null,"该功能不支持网页端访问，APP正在研发中！",m.a.createElement(f.b,{onClick:this.donation,type:"primary"},"催促一下快点开发"))}),m.a.createElement("div",{style:{marginTop:25}},m.a.createElement(f.b,{type:"primary",onClick:this.qg},"玩客云抢购")),m.a.createElement(f.a,{layout:"inline",onSubmit:this.handleSubmit,style:{marginTop:25}},m.a.createElement(g,{label:"页面地址"},o("url",{rules:[{required:!0,message:"请输入页面地址"}]})(m.a.createElement(f.c,null))),m.a.createElement(g,null,m.a.createElement(f.b,{type:"primary",htmlType:"submit"},"抓取"))),m.a.createElement(f.d,{style:{marginTop:24},type:"inner",title:"优惠券列表"},m.a.createElement(f.e,{gutter:50},t.map(function(n,t){return m.a.createElement(v.a,{item:n,key:n.id,couponSelected:e.selectCoupon.bind(e,n),show:"all"})}))),m.a.createElement(w.a,{visible:this.state.visible,onCancel:this.handleCancel}))}}]),n}(m.a.Component),C=f.a.create()(E);C.propTypes={},n.a=C},1241:function(e,n,t){"use strict";var r=t(525),o=function(e,n){try{var t=window.require("electron").remote.BrowserWindow,o=window.require("electron").ipcRenderer,a=t.getFocusedWindow().id,i=new t({width:400,height:400,show:!0});i.loadURL(e),i.webContents.on("did-finish-load",function(){i.webContents.executeJavaScript("\n      var data =[]\n      var result;\n      function GenNonDuplicateID(i){\n          i = i || 1\n          return Number(Math.random().toString().substr(3, i) + Date.now()).toString(36)\n        }\n      for(var key in window){\n          if(/^data/.test(key)){\n              var datas = window[key]\n              for(var n in datas){\n                  if(datas[n] && datas[n].couponList && datas[n].couponList.length){\n                    datas[n].couponList.map(function(m){\n                      data.push(m)\n                    })\n      \n                  }\n              }\n            result = formatResult(data)\n          }\n      }\n      function formatResult(data){\n          var arr = Array.from(new Set(data))\n          var res = []\n        arr.map(function(item){\n              if(!item.args) return;\n              var r = item.args.split(',').join('&')\n              var s = item.args.replace('key=','actId=').split(',').join('&')\n              //var id = GenNonDuplicateID()\n          res.push({\n                id: item.cpId,\n                title: item.scope,\n                priceLess: item.val,\n                condition: item.limit,\n                url: 'http://coupon.m.jd.com/center/receiveCoupon.json?couponId='+item.cpId+'&'+s,\n                baseUrl:'http://coupon.m.jd.com/coupons/show.action?'+r,\n                note: item.beginPeriod + ' - ' + item.endPeriod\n              })\n          })\n          return res;\n      }\n\t\tconst ipc = window.require('electron').ipcRenderer\n\t\tconst BrowserWindow = window.require('electron').remote.BrowserWindow\n\t  console.log(ipc)\n\t\tipc.on('start-grab', function (event, fromWindowId) {\n\t\t  const fromWindow = BrowserWindow.fromId(fromWindowId)\n\t\t  fromWindow.webContents.send('grab-finished', result)\n\t\t  window.close()\n\t\t})\n\t"),i.webContents.send("start-grab",a)}),o.on("grab-finished",function(e,t){n.resultSet(t)})}catch(e){r.j.error("不支持网页访问")}};n.a=o}});