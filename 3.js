webpackJsonp([3],{1189:function(e,n,t){"use strict";function o(e){return console.log(e),{type:p,payload:e}}function r(e){return{type:m,payload:e}}function i(e){return{type:f,payload:e}}function a(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:C,n=arguments[1],t=g[n.type];return t?t(e,n):e}Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"COUPON_ADD",function(){return p}),t.d(n,"COUPON_SELECTED",function(){return m}),t.d(n,"COUPON_STARTED_CHANGE",function(){return f}),t.d(n,"COUNTER_INCREMENT",function(){return w}),t.d(n,"COUNTER_DOUBLE_ASYNC",function(){return h}),n.couponAdd=o,n.couponSelected=r,n.couponStartedChange=i,t.d(n,"actions",function(){return v}),n.default=a;var c,d=t(9),l=t.n(d),s=t(66),u=t.n(s),p="COUPON_ADD",m="COUPON_SELECTED",f="COUPON_STARTED_CHANGE",w="COUNTER_INCREMENT",h="COUNTER_DOUBLE_ASYNC",b=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Number(Math.random().toString().substr(3,e)+Date.now()).toString(36)},v={couponSelected:r,couponStartedChange:i,couponAdd:o},g=(c={},l()(c,p,function(e,n){var t=n.payload;return console.log(t),t.length?(t.map(function(e){if(!e.id)return e.id="JD_"+b()}),t=t.filter(function(e){return e.url&&e.title&&e.priceLess})):t.url&&!t.id&&(t.id="JD_"+b(),t=[t]),Object.assign({},e,{list:[].concat(u()(e.list),u()(t))})}),l()(c,m,function(e,n){var t=n.payload;return Object.assign({},e,{list:e.list.map(function(e){return e.id===t.id&&(e.isSelected=!e.isSelected),e})})}),l()(c,f,function(e,n){var t=n.payload;return Object.assign({},e,{list:e.list.map(function(e){return e.isSelected&&(e.started=t),e})})}),l()(c,h,function(e,n){return 2*e}),c),C={list:[{id:"JD_1",title:"话费券",priceLess:"50",condition:"满50可用",url:"http://coupon.m.jd.com/center/receiveCoupon.json?couponId=FP_rzw62e&roleId=9522110&actId=5550d895d0e8447a82366b4667a5a079",note:"10点开抢"},{id:"JD_2",title:"仅可购买母婴玩具自营（除童装童鞋）部分商品",priceLess:"100",condition:"满399可用",url:"http://coupon.m.jd.com/center/receiveCoupon.json?couponId=FP_r6zwli&roleId=9563848&actId=f62f9b45d4f94870b0c99ecaba36ceb7",note:"16点开抢"},{id:"JD_3",title:"全品类",priceLess:"10",condition:"满200可用",url:"http://api.m.jd.com/client.action?functionId=newBabelAwardCollection&body=%7B%22activityId%22%3A%22JnBNfziTrMkqi6mBCaegM3SdVTL%22%2C%22from%22%3A%22H5node%22%2C%22scene%22%3A%221%22%2C%22args%22%3A%22key%3Da327e6761c5a475db749ac9c0d09000e%2CroleId%3D9491958%22%2C%22mitemAddrId%22%3A%22%22%2C%22geo%22%3A%7B%22lng%22%3A%22%22%2C%22lat%22%3A%22%22%7D%7D&client=wh5&clientVersion=1.0.0&sid=2ef0a060f4976cf16ce8dacbbb4acdaa&uuid=1486988610523463373612&area=&_=1512870608248&callback=jsonp5",note:"10点开抢"},{id:"JD_4",title:"全品类",priceLess:"20",condition:"满400可用",url:"https://api.m.jd.com/client.action?functionId=newBabelAwardCollection&body=%7B%22activityId%22%3A%22JnBNfziTrMkqi6mBCaegM3SdVTL%22%2C%22from%22%3A%22H5node%22%2C%22scene%22%3A%221%22%2C%22args%22%3A%22key%3Dbeb14768b14c4a5eb56af44d286ca58a%2CroleId%3D9490476%22%2C%22mitemAddrId%22%3A%22%22%2C%22geo%22%3A%7B%22lng%22%3A%22%22%2C%22lat%22%3A%22%22%7D%7D&client=wh5&clientVersion=1.0.0&sid=2ef0a060f4976cf16ce8dacbbb4acdaa&uuid=1486988610523463373612&area=&_=1512870737852&callback=jsonp6",note:"10点开抢"},{id:"JD_5",title:"仅可购买自营尿裤部分商品",priceLess:"100",condition:"满399可用",url:"http://coupon.m.jd.com/center/receiveCoupon.json?couponId=FP_rxzlqk&roleId=9487347&actId=6bd6339fd57d45a4a91f34e0d3783e5a",note:"16点开抢"}]}},1190:function(e,n,t){"use strict";function o(e){return console.log(e),{type:u,payload:e}}function r(e){return{type:p,payload:e}}function i(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:h,n=arguments[1],t=w[n.type];return t?t(e,n):e}Object.defineProperty(n,"__esModule",{value:!0}),t.d(n,"COUPON_GRAB_ADD",function(){return u}),t.d(n,"COUPON_SELECTED",function(){return p}),n.couponAdd=o,n.couponSelected=r,t.d(n,"actions",function(){return f}),n.default=i;var a,c=t(9),d=t.n(c),l=t(66),s=t.n(l),u="COUPON_GRAB_ADD",p="COUPON_SELECTED",m=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return Number(Math.random().toString().substr(3,e)+Date.now()).toString(36)},f={couponSelected:r,couponAdd:o},w=(a={},d()(a,u,function(e,n){var t=n.payload;return t.length?(t.map(function(e){if(!e.id)return e.id="JD_"+m()}),t=t.filter(function(e){return e.url&&e.title&&e.priceLess})):t.url&&!t.id&&(t.id="JD_"+m(),t=[t]),[].concat(s()(e),s()(t))}),d()(a,p,function(e,n){var t=n.payload;return[].concat(s()(e.map(function(e){return e.id===t.id&&(e.isSelected=!e.isSelected),e})))}),a),h=[]},1194:function(e,n,t){"use strict";Object.defineProperty(n,"__esModule",{value:!0});var o=t(138),r=t(1190),i=t(1189),a=t(1211),c={couponSelected:r.couponSelected,couponAdd:r.couponAdd,couponPost:i.couponAdd},d=function(e){return e};n.default=t.i(o.connect)(d,c)(a.a)},1201:function(e,n,t){"use strict";var o=t(0),r=t.n(o),i=t(5),a=(t.n(i),t(524)),c=function(e){return r.a.createElement(a.g,{message:"提示",description:r.a.createElement("div",null,"抢券前请确保已登陆京东 ",r.a.createElement("a",{target:"_blank",href:"http://home.jd.com/"},"登录电脑版")," ",r.a.createElement("a",{target:"_blank",href:"https://home.m.jd.com/myJd/newhome.action"},"登录手机版")),type:"warning",showIcon:!0})};c.propTypes={},n.a=c},1206:function(e,n,t){"use strict";var o=t(1),r=t.n(o),i=t(8),a=t.n(i),c=t(3),d=t.n(c),l=t(2),s=t.n(l),u=t(0),p=t.n(u),m=t(524),f=function(e){function n(){var e,t,o,i;r()(this,n);for(var a=arguments.length,c=Array(a),l=0;l<a;l++)c[l]=arguments[l];return t=o=d()(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(c))),o.state={started:!1,result:!1},o.componentWillReceiveProps=function(e){var n=e.item,t=e.show;n.started&&"selected"===t?o.startCoupon(n):o.endCoupon(n)},o.timer=[],o.next=0,o.startCoupon=function(e){var n=e.id,t=e.url;o.setState({started:!0,result:!0}),o.timer[n]=setInterval(function(){console.log({id:n,url:t}),this.next,$("#iframe"+n).attr("src",t),this.next=this.next+1},320)},o.endCoupon=function(e){var n=e.id;o.timer[n]&&(o.setState({result:!1}),clearInterval(o.timer[n]))},o.onCouponSelected=function(e){var n=o.props.couponSelected;o.setState({started:!1}),o.timer[e.id]&&o.endCoupon(e),n(e)},i=t,d()(o,i)}return s()(n,e),a()(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.item,o=n.show;return p.a.createElement(m.f,{span:6,"data-url":t.url,className:"gutter-row coupon-item"},p.a.createElement("div",null,p.a.createElement("div",{className:"price"},p.a.createElement("em",null,"¥"),p.a.createElement("strong",null,t.priceLess)),p.a.createElement("div",null,p.a.createElement("span",{className:"limit"},t.condition),/m.jd/.test(t.url)?p.a.createElement("span",{className:"device"},"手机端"):p.a.createElement("span",{className:"device"},"PC端")),p.a.createElement("h3",{dangerouslySetInnerHTML:{__html:t.title}}),p.a.createElement("p",{dangerouslySetInnerHTML:{__html:t.note?t.note:"请确保已登陆京东"}}),p.a.createElement("p",null,t.baseUrl?p.a.createElement("a",{href:t.baseUrl,target:"_blank"},"直达优惠券页面"):"")),this.state.started?p.a.createElement("div",null,p.a.createElement("iframe",{id:"iframe"+t.id,src:""})):"",function(n){switch(o){case"all":return p.a.createElement("div",{className:"control"},p.a.createElement(m.b,{type:"primary",onClick:e.onCouponSelected.bind(e,n),disabled:n.isSelected},"选择"));case"selected":return p.a.createElement("div",{className:"control justify"},e.state.result?p.a.createElement(m.b,{type:"primary",onClick:e.endCoupon.bind(e,n)},"结束抢券"):p.a.createElement(m.b,{type:"primary",onClick:e.startCoupon.bind(e,n)},"开始抢券"),p.a.createElement(m.b,{type:"danger",onClick:e.onCouponSelected.bind(e,n)},"删除"))}}(t))}}]),n}(u.Component);n.a=f},1207:function(e,n,t){"use strict";var o=t(524),r=function(e,n){try{var t=window.require("electron").remote.BrowserWindow,r=window.require("electron").ipcRenderer,i=t.getFocusedWindow().id;console.log(window.require("electron"));var a="https://wqs.jd.com/order/s_confirm_miao.shtml?scene=jd&isCanEdit=1&src=&commlist=,,1,"+e+"&urlType=login#wechat_redirect",c=new t({width:400,height:550,show:!0});c.loadURL(a),c.webContents.on("did-finish-load",function(){c.webContents.executeJavaScript("\n        var tcUrl = `https://wqs.jd.com/order/s_confirm_miao.shtml?scene=jd&isCanEdit=1&src=&commlist=,,1,"+e+"&urlType=login#wechat_redirect`\n        // 订单提交速度，测试在4750ms提交一次才行\n        var tcDelay = 4750;\n        // 如果抢购失败则关闭弹窗 继续抢购\n        function tc ($el,$btn){\n          if($btn){$btn.trigger('click')}\n            $el.trigger('click')\n        }\n        // 监听弹出窗口并继续抢购\n        $('body').bind('DOMNodeInserted', function(e) {\n          var $btn = $(e.target).find('.btn')\n          if($btn.length){\n            setTimeout(function(){\n            tc($(\"#btnWxH5Pay\"),$btn)\n          },tcDelay)\n          }\n        });\n        // 防止多次提交后不会弹窗，只是一串提示信息\n        $('#wrapBody').bind('DOMNodeInserted', function(e) {\n          var $info = $(e.target).hasClass('show')\n          if($info){\n            setTimeout(function(){\n              tc($(\"#btnWxH5Pay\"))\n            },tcDelay)\n          }\n        });\n\n        // 判断是否为抢购页面\n        if(/s_confirm_miao.shtml/.test(location.href)){\n          // 点击微信支付\n          tc($(\"#btnWxH5Pay\"))\n        }else if(/plogin.m.jd.com/.test(location.href)){\n          // 如果为登录页面 则等待登录\n          // message.info(等待登录)\n        }else{\n          // location.href = url\n          // console.log(tcUrl)\n          // tc($(\"#btnWxH5Pay\"))\n        }\n        var tc_result ='hi'\n        const ipc = window.require('electron').ipcRenderer\n        // var BrowserWindow = BrowserWindow\n        // var ipc = ipcRenderer\n        const BrowserWindow = window.require('electron').remote.BrowserWindow\n        ipc.on('compute-factorial', function (event, fromWindowId) {\n          const fromWindow = BrowserWindow.fromId(fromWindowId)\n          fromWindow.webContents.send('grab-finished', tc_result)\n          window.close()\n        })\n      "),c.webContents.send("compute-factorial",i)}),r.on("factorial-computed",function(e,n){console.log(n)})}catch(e){o.h.error("不支持网页访问")}};n.a=r},1211:function(e,n,t){"use strict";var o=t(1),r=t.n(o),i=t(8),a=t.n(i),c=t(3),d=t.n(c),l=t(2),s=t.n(l),u=t(0),p=t.n(u),m=t(5),f=(t.n(m),t(524)),w=t(1201),h=t(1206),b=t(1212),v=t(1207),g=f.a.Item,C=function(e){function n(){var e,o,i,a;r()(this,n);for(var c=arguments.length,l=Array(c),s=0;s<c;s++)l[s]=arguments[s];return o=i=d()(this,(e=n.__proto__||Object.getPrototypeOf(n)).call.apply(e,[this].concat(l))),i.state={},i.handleSubmit=function(e){e.preventDefault(),i.props.form.validateFields(function(e,n){var o=n.url;e||(console.log("Received values of form: ",o),t.i(b.a)(o,i))})},i.resultSet=function(e){(0,i.props.couponAdd)(e)},i.selectCoupon=function(e){var n=i.props,t=n.couponSelected;(0,n.couponPost)(e),t(e)},i.qg=function(e){var n=e.proId,o=void 0===n?4993737:n;t.i(v.a)(o)},a=o,d()(i,a)}return s()(n,e),a()(n,[{key:"render",value:function(){var e=this,n=this.props,t=n.grab,o=n.form,r=o.getFieldDecorator;return p.a.createElement("div",{ref:"grab"},p.a.createElement(w.a,null),p.a.createElement("div",{style:{marginTop:25}},p.a.createElement(f.b,{type:"primary",onClick:this.qg},"玩客云抢购")),p.a.createElement(f.a,{layout:"inline",onSubmit:this.handleSubmit,style:{marginTop:25}},p.a.createElement(g,{label:"页面地址"},r("url",{rules:[{required:!0,message:"请输入页面地址"}]})(p.a.createElement(f.c,null))),p.a.createElement(g,null,p.a.createElement(f.b,{type:"primary",htmlType:"submit"},"抓取"))),p.a.createElement(f.d,{style:{marginTop:24},type:"inner",title:"优惠券列表"},p.a.createElement(f.e,{gutter:50},t.map(function(n,t){return p.a.createElement(h.a,{item:n,key:n.id,couponSelected:e.selectCoupon.bind(e,n),show:"all"})}))))}}]),n}(p.a.Component),y=f.a.create()(C);y.propTypes={},n.a=y},1212:function(e,n,t){"use strict";var o=t(524),r=function(e,n){try{var t=window.require("electron").remote.BrowserWindow,r=window.require("electron").ipcRenderer,i=t.getFocusedWindow().id,a=new t({width:400,height:400,show:!0});a.loadURL(e),a.webContents.on("did-finish-load",function(){a.webContents.executeJavaScript("\n      var data =[]\n      var result;\n      function GenNonDuplicateID(i){\n          i = i || 1\n          return Number(Math.random().toString().substr(3, i) + Date.now()).toString(36)\n        }\n      for(var key in window){\n          if(/^data/.test(key)){\n              var datas = window[key]\n              for(var n in datas){\n                  if(datas[n] && datas[n].couponList && datas[n].couponList.length){\n                    datas[n].couponList.map(function(m){\n                      data.push(m)\n                    })\n      \n                  }\n              }\n            result = formatResult(data)\n          }\n      }\n      function formatResult(data){\n          var arr = Array.from(new Set(data))\n          var res = []\n        arr.map(function(item){\n              if(!item.args) return;\n              var r = item.args.split(',').join('&')\n              var s = item.args.replace('key=','actId=').split(',').join('&')\n              //var id = GenNonDuplicateID()\n          res.push({\n                id: item.cpId,\n                title: item.scope,\n                priceLess: item.val,\n                condition: item.limit,\n                url: 'http://coupon.m.jd.com/center/receiveCoupon.json?couponId='+item.cpId+'&'+s,\n                baseUrl:'http://coupon.m.jd.com/coupons/show.action?'+r,\n                note: item.beginPeriod + ' - ' + item.endPeriod\n              })\n          })\n          return res;\n      }\n\t\tconst ipc = window.require('electron').ipcRenderer\n\t\tconst BrowserWindow = window.require('electron').remote.BrowserWindow\n\t  console.log(ipc)\n\t\tipc.on('start-grab', function (event, fromWindowId) {\n\t\t  const fromWindow = BrowserWindow.fromId(fromWindowId)\n\t\t  fromWindow.webContents.send('grab-finished', result)\n\t\t  window.close()\n\t\t})\n\t"),a.webContents.send("start-grab",i)}),r.on("grab-finished",function(e,t){n.resultSet(t)})}catch(e){o.h.error("不支持网页访问")}};n.a=r}});